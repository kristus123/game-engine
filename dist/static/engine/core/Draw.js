import{AssertNotNull}from"/static/engine/assertions/AssertNotNull.js";import{a}from"/static/engine/code_tools/a.js";import{Mouse}from"/static/engine/controller/Mouse.js";import{Palette}from"/static/engine/core/Palette.js";import{Camera}from"/static/engine/core/camera/Camera.js";import{Text}from"/static/engine/mechanics/dialogue/Text.js";import{Position}from"/static/engine/position/Position.js";export class Draw{constructor(t){AssertNotNull(t,"argument ctx in "+this.constructor.name+".js should not be null"),this.ctx=t,this.angle=0}angleFrom(t,i,e,s,h){const o=Math.atan2(i.y-t.y,i.x-t.x),c=s/2,a=o-c*Math.PI/180,l=o+c*Math.PI/180;this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.arc(t.x,t.y,e,a,l),this.ctx.lineTo(t.x,t.y),this.ctx.fillStyle=h,this.ctx.fill()}angleFromMouse(t,i,e,s){this.angleFrom(t,Mouse,i,e,s)}test(t){const i=800,e=400,s=this.ctx.createLinearGradient(t.x-400,t.y-200,t.x+400,t.y+200);s.addColorStop(0,"rgba(255, 255, 255, 0.3)"),s.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),s.addColorStop(1,"rgba(255, 255, 255, 0)"),this.ctx.fillStyle=s,this.ctx.fillRect(t.x-400,t.y-200,i,e)}lightSource(t,i){const e=this.ctx.createRadialGradient(t.x,t.y,0,t.x,t.y,i);e.addColorStop(0,"rgba(255, 255, 255, 1)"),e.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.fillStyle=e,this.ctx.fillRect(0,0,Palette.width,Palette.height)}curve(t,i,e,s){this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.bezierCurveTo(i.x,i.y,e.x,e.y,s.x,s.y),this.ctx.strokeStyle="white",this.ctx.stroke()}shadow(t){const{x:i,y:e,width:s,height:h}=t;this.ctx.shadowColor="rgba(0, 0, 0, 0.5)",this.ctx.shadowBlur=200,this.ctx.shadowOffsetX=(i-0)/10,this.ctx.shadowOffsetY=(e-0)/10,this.ctx.fillRect(i,e,s,h),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0}sprite(t,i,e){this.ctx.imageSmoothingEnabled=!1,this.ctx.drawImage(e,i.x,i.y,i.width,i.height,t.x,t.y,t.width,t.height)}imageBitmap(t,i){this.ctx.drawImage(i,t.x,t.y)}rectangle(t,i="yellow"){this.ctx.fillStyle=i,this.ctx.fillRect(t.x,t.y,t.width,t.height),this.ctx.strokeStyle=i,this.ctx.lineWidth=4,this.ctx.strokeRect(t.x,t.y,t.width,t.height),this.ctx.fillStyle="white",this.ctx.font="25px Arial"}pink(t){this.rectangle(t,"pink")}purple(t){this.rectangle(t,"purple")}green(t){this.rectangle(t,"green")}red(t){this.rectangle(t,"red")}brown(t){this.rectangle(t,"brown")}orange(t){this.rectangle(t,"orange")}blue(t){this.rectangle(t,"blue")}color(t,i){this.rectangle(t,i)}grey(t){this.rectangle(t,"grey")}transparentGreenRectangle(t){this.ctx.fillStyle="rgba(0, 255, 0, 0.5)",this.ctx.fillRect(t.x,t.y,t.width,t.height)}transparentRedRectangle(t){this.ctx.fillStyle="rgba(255, 0, 0, 0.5)",this.ctx.fillRect(t.x,t.y,t.width,t.height)}transparentBlueRectangle(t){this.ctx.fillStyle="rgba(0, 0, 255, 0.5)",this.ctx.fillRect(t.x,t.y,t.width,t.height)}blueRectangle(t){this.ctx.fillStyle="rgba(0, 0, 255, 1)",this.ctx.fillRect(t.x,t.y,t.width,t.height)}gradient(t){const i=this.ctx.createRadialGradient(t.x,t.y,200,t.x,t.y,50);i.addColorStop(0,"rgba(255, 0, 255, 0.1)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),i.addColorStop(1,"rgba(255, 255, 0, 0.1)"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,300,0,2*Math.PI),this.ctx.fill()}star(t,i="white"){this.ctx.lineWidth=0,this.ctx.fillStyle=i,this.ctx.strokeStyle=i,this.rectangle(t,i)}splash(t,i,e,s=500){this.ctx.beginPath();const h=Math.atan2(i.y-t.y,i.x-t.x),o=h-e/2,c=h+e/2,a=t.x+s*Math.cos(o),l=t.y+s*Math.sin(o),x=t.x+s*Math.cos(c),r=t.y+s*Math.sin(c);this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(a,l),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(x,r),this.ctx.lineWidth=2,this.ctx.strokeStyle="red"}hpBar(t,i,e,s="red"){t={x:t.x-100,y:t.y+50},this.ctx.fillStyle="white",this.ctx.fillRect(t.x,t.y,200,20);let h=Math.max(0,i/e*100/100-.01);this.ctx.fillStyle=s,this.ctx.fillRect(t.x,t.y,200*h,20)}circle(t,i=10){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,i,0,2*Math.PI,!1),this.ctx.fillStyle="red",this.ctx.fill()}hollowCircle(t,i,e){this.ctx.strokeStyle=i,this.ctx.lineWidth=6,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e,0,2*Math.PI),this.ctx.stroke()}circleSpinning(t,i){const e=t.x+t.width/2+i*Math.cos(this.angle),s=t.y+t.height/2+i*Math.sin(this.angle);return this.circle(e,s,10,"red"),this.angle+=.1,{x:e,y:s}}revertMouse(t,i){const e=t.angle+Math.PI,s=t.x+t.width/2+100*Math.cos(e),h=t.y+t.height/2+100*Math.sin(e);this.circle(s,h,10,"red"),t.angle=Math.atan2(i.y-t.position.center.y,i.x-t.position.center.x)}objectThatIsMovingInRectangularPathAroundObject(t,i="red"){this.ctx.lineWidth=2;const e=t.x-Camera.position.x,s=t.y-Camera.position.y,h=Palette.width/2-20,o=Palette.height/2-20;let c=Camera.position.x+Math.min(Math.abs(e),h)*Math.sign(e),a=Camera.position.y+Math.min(Math.abs(s),o)*Math.sign(s);this.circle(c,a,10,i);const l=Camera.position.x-h,x=Camera.position.y-o,r=2*h,n=2*o;return this.ctx.strokeStyle="blue",this.ctx.strokeRect(l,x,r,n),{x:c,y:a}}objectThatIsCirclingAroundObjectBasedOnMousePosition(t){t={x:t.position.center.x,y:t.position.center.y};const i=Mouse.position.x,e=Mouse.position.y,s=Math.atan2(e-t.y,i-t.x),h=t.x+150*Math.cos(s),o=t.y+150*Math.sin(s);this.circle(new Position(h,o),10,"red")}line(t,i){this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(i.x,i.y),this.ctx.strokeStyle="white",this.ctx.lineWidth=5,this.ctx.stroke()}text(t,i,e="black",s=40){this.ctx.fillStyle="white",this.ctx.font=s/Camera.zoom+"px VT323";const h=this.ctx.measureText(i).width;this.ctx.fillRect(t.x,t.y-s-20,h,s+40),this.ctx.fillStyle=e,this.ctx.fillText(i,t.x,t.y)}position(t){this.text(t,`${Math.floor(t.x)} _ ${Math.floor(t.y)}`)}grid(){this.ctx.strokeStyle="#ccc",this.ctx.lineWidth=2;const t=100,i=1e3,e=1e3,s=Math.floor(10),h=Math.floor(10);for(let e=0;e<s;e++)this.ctx.beginPath(),this.ctx.moveTo(0,e*t),this.ctx.lineTo(i,e*t),this.ctx.stroke();this.ctx.beginPath(),this.ctx.moveTo(0,e),this.ctx.lineTo(i,e),this.ctx.stroke();for(let i=0;i<h;i++)this.ctx.beginPath(),this.ctx.moveTo(i*t,0),this.ctx.lineTo(i*t,e),this.ctx.stroke();this.ctx.beginPath(),this.ctx.moveTo(i,0),this.ctx.lineTo(i,e),this.ctx.stroke()}}