import{AsepriteJson}from"/static/engine/AsepriteJson.js";import{G}from"/static/engine/G.js";import{a}from"/static/engine/code_tools/a.js";import{Call}from"/static/engine/code_tools/tools/Call.js";import{Controller}from"/static/engine/controller/Controller.js";import{Mouse}from"/static/engine/controller/Mouse.js";import{MouseEditor}from"/static/engine/controller/mouse/MouseEditor.js";import{Draw}from"/static/engine/core/Draw.js";import{Level}from"/static/engine/core/Level.js";import{Loop}from"/static/engine/core/Loop.js";import{Palette}from"/static/engine/core/Palette.js";import{RightClickMenu}from"/static/engine/core/RightClickMenu.js";import{Camera}from"/static/engine/core/camera/Camera.js";import{ErrorHandler}from"/static/engine/core/logging/ErrorHandler.js";import{ShowLogs}from"/static/engine/core/logging/ShowLogs.js";import{Physics}from"/static/engine/core/physics/Physics.js";import{WorldEditor}from"/static/engine/editor/WorldEditor.js";import{Sprite}from"/static/engine/graphics/sprite/Sprite.js";import{Http}from"/static/engine/http/Http.js";import{StaticHttp}from"/static/engine/http/StaticHttp.js";import{Text}from"/static/engine/mechanics/dialogue/Text.js";import{VideoCall}from"/static/engine/socket/VideoCall.js";import{D}from"/static/game/world/D.js";import{World}from"/static/game/world/World.js";export const index="";function loadImage(e){return new Promise((t,o)=>{const r=new Image;r.src=e,r.onerror=o,r.complete?t(r):r.onload=()=>t(r)})}const whenLoaded=Promise.all(["/static/assets/flower","/static/assets/grass","/static/assets/player/player","/static/assets/player/viking","/static/assets/sign","/static/assets/wheat","/static/assets/world"].map(e=>{const t=e.split("/").pop(),o=e+".png",r=new AsepriteJson(StaticHttp.get(e+".json"));return loadImage(o).then(e=>G.Sprite[t]=t=>new Sprite(t,e,r))}));whenLoaded.then(()=>{ErrorHandler.run(()=>{const e=Palette.main(),t=Palette.offscreen(),o=Palette.offscreen();Mouse.initialize(),Camera.initialize(),Mouse.initializeAfterCameraIsInitialized();const r=new Draw(Camera.palette.ctx),i=new Draw(t.ctx),a=new RightClickMenu;Level.change(new World),Loop.everyFrame(s=>{ErrorHandler.run(()=>{Palette.clear([Camera.palette,t]),Physics.global.update(s),Camera.context(()=>{Mouse.update(),Controller.update(),Controller.draw(r,i),Level.update(),Level.draw(r,i),a.update(),a.draw(r,i),Text.updateAll(),Mouse.draw(r,i),MouseEditor.active&&(MouseEditor.active.update(),MouseEditor.active.draw(r,i))}),Palette.fill(o,"black"),Palette.apply(e,[o,Camera.palette,t])})})})}).catch(e=>{throw console.error("Image failed to load",e),e});